<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API &mdash; checkdmarc 5.2.7 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=92fd9be5" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=e657c2dd"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="CLI" href="cli.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            checkdmarc
          </a>
              <div class="version">
                5.2.7
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-checkdmarc">checkdmarc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.check_domains"><code class="docutils literal notranslate"><span class="pre">check_domains()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.check_ns"><code class="docutils literal notranslate"><span class="pre">check_ns()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.output_to_file"><code class="docutils literal notranslate"><span class="pre">output_to_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.results_to_csv"><code class="docutils literal notranslate"><span class="pre">results_to_csv()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.results_to_csv_rows"><code class="docutils literal notranslate"><span class="pre">results_to_csv_rows()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.results_to_json"><code class="docutils literal notranslate"><span class="pre">results_to_json()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-checkdmarc.bimi">checkdmarc.bimi</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.bimi.BIMIError"><code class="docutils literal notranslate"><span class="pre">BIMIError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.bimi.BIMIRecordInWrongLocation"><code class="docutils literal notranslate"><span class="pre">BIMIRecordInWrongLocation</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.bimi.BIMIRecordNotFound"><code class="docutils literal notranslate"><span class="pre">BIMIRecordNotFound</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.bimi.BIMISyntaxError"><code class="docutils literal notranslate"><span class="pre">BIMISyntaxError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.bimi.InvalidBIMIIndicatorURI"><code class="docutils literal notranslate"><span class="pre">InvalidBIMIIndicatorURI</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.bimi.InvalidBIMITag"><code class="docutils literal notranslate"><span class="pre">InvalidBIMITag</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.bimi.InvalidBIMITagValue"><code class="docutils literal notranslate"><span class="pre">InvalidBIMITagValue</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.bimi.MultipleBIMIRecords"><code class="docutils literal notranslate"><span class="pre">MultipleBIMIRecords</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.bimi.SPFRecordFoundWhereBIMIRecordShouldBe"><code class="docutils literal notranslate"><span class="pre">SPFRecordFoundWhereBIMIRecordShouldBe</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.bimi.UnrelatedTXTRecordFoundAtBIMI"><code class="docutils literal notranslate"><span class="pre">UnrelatedTXTRecordFoundAtBIMI</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.bimi.check_bimi"><code class="docutils literal notranslate"><span class="pre">check_bimi()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.bimi.parse_bimi_record"><code class="docutils literal notranslate"><span class="pre">parse_bimi_record()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.bimi.query_bimi_record"><code class="docutils literal notranslate"><span class="pre">query_bimi_record()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-checkdmarc.dmarc">checkdmarc.dmarc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.dmarc.DMARCError"><code class="docutils literal notranslate"><span class="pre">DMARCError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.dmarc.DMARCRecordInWrongLocation"><code class="docutils literal notranslate"><span class="pre">DMARCRecordInWrongLocation</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.dmarc.DMARCRecordNotFound"><code class="docutils literal notranslate"><span class="pre">DMARCRecordNotFound</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.dmarc.DMARCRecordStartsWithWhitespace"><code class="docutils literal notranslate"><span class="pre">DMARCRecordStartsWithWhitespace</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.dmarc.DMARCReportEmailAddressMissingMXRecords"><code class="docutils literal notranslate"><span class="pre">DMARCReportEmailAddressMissingMXRecords</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.dmarc.DMARCSyntaxError"><code class="docutils literal notranslate"><span class="pre">DMARCSyntaxError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.dmarc.InvalidDMARCReportURI"><code class="docutils literal notranslate"><span class="pre">InvalidDMARCReportURI</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.dmarc.InvalidDMARCTag"><code class="docutils literal notranslate"><span class="pre">InvalidDMARCTag</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.dmarc.InvalidDMARCTagValue"><code class="docutils literal notranslate"><span class="pre">InvalidDMARCTagValue</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.dmarc.MultipleDMARCRecords"><code class="docutils literal notranslate"><span class="pre">MultipleDMARCRecords</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.dmarc.SPFRecordFoundWhereDMARCRecordShouldBe"><code class="docutils literal notranslate"><span class="pre">SPFRecordFoundWhereDMARCRecordShouldBe</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.dmarc.UnrelatedTXTRecordFoundAtDMARC"><code class="docutils literal notranslate"><span class="pre">UnrelatedTXTRecordFoundAtDMARC</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.dmarc.UnverifiedDMARCURIDestination"><code class="docutils literal notranslate"><span class="pre">UnverifiedDMARCURIDestination</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.dmarc.check_dmarc"><code class="docutils literal notranslate"><span class="pre">check_dmarc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.dmarc.check_wildcard_dmarc_report_authorization"><code class="docutils literal notranslate"><span class="pre">check_wildcard_dmarc_report_authorization()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.dmarc.get_dmarc_record"><code class="docutils literal notranslate"><span class="pre">get_dmarc_record()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.dmarc.get_dmarc_tag_description"><code class="docutils literal notranslate"><span class="pre">get_dmarc_tag_description()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.dmarc.parse_dmarc_record"><code class="docutils literal notranslate"><span class="pre">parse_dmarc_record()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.dmarc.parse_dmarc_report_uri"><code class="docutils literal notranslate"><span class="pre">parse_dmarc_report_uri()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.dmarc.query_dmarc_record"><code class="docutils literal notranslate"><span class="pre">query_dmarc_record()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.dmarc.verify_dmarc_report_destination"><code class="docutils literal notranslate"><span class="pre">verify_dmarc_report_destination()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-checkdmarc.dnssec">checkdmarc.dnssec</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.dnssec.get_dnskey"><code class="docutils literal notranslate"><span class="pre">get_dnskey()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.dnssec.get_tlsa_records"><code class="docutils literal notranslate"><span class="pre">get_tlsa_records()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.dnssec.test_dnssec"><code class="docutils literal notranslate"><span class="pre">test_dnssec()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-checkdmarc.mta_sts">checkdmarc.mta_sts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.mta_sts.InvalidMTASTSTag"><code class="docutils literal notranslate"><span class="pre">InvalidMTASTSTag</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.mta_sts.InvalidSTSTagValue"><code class="docutils literal notranslate"><span class="pre">InvalidSTSTagValue</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.mta_sts.MTASTSError"><code class="docutils literal notranslate"><span class="pre">MTASTSError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.mta_sts.MTASTSPolicyDownloadError"><code class="docutils literal notranslate"><span class="pre">MTASTSPolicyDownloadError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.mta_sts.MTASTSPolicyError"><code class="docutils literal notranslate"><span class="pre">MTASTSPolicyError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.mta_sts.MTASTSPolicySyntaxError"><code class="docutils literal notranslate"><span class="pre">MTASTSPolicySyntaxError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.mta_sts.MTASTSRecordInWrongLocation"><code class="docutils literal notranslate"><span class="pre">MTASTSRecordInWrongLocation</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.mta_sts.MTASTSRecordNotFound"><code class="docutils literal notranslate"><span class="pre">MTASTSRecordNotFound</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.mta_sts.MTASTSRecordSyntaxError"><code class="docutils literal notranslate"><span class="pre">MTASTSRecordSyntaxError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.mta_sts.MultipleMTASTSRecords"><code class="docutils literal notranslate"><span class="pre">MultipleMTASTSRecords</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.mta_sts.SPFRecordFoundWhereMTASTSRecordShouldBe"><code class="docutils literal notranslate"><span class="pre">SPFRecordFoundWhereMTASTSRecordShouldBe</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.mta_sts.UnrelatedTXTRecordFoundAtMTASTS"><code class="docutils literal notranslate"><span class="pre">UnrelatedTXTRecordFoundAtMTASTS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.mta_sts.check_mta_sts"><code class="docutils literal notranslate"><span class="pre">check_mta_sts()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.mta_sts.download_mta_sts_policy"><code class="docutils literal notranslate"><span class="pre">download_mta_sts_policy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.mta_sts.mx_in_mta_sts_patterns"><code class="docutils literal notranslate"><span class="pre">mx_in_mta_sts_patterns()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.mta_sts.parse_mta_sts_policy"><code class="docutils literal notranslate"><span class="pre">parse_mta_sts_policy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.mta_sts.parse_mta_sts_record"><code class="docutils literal notranslate"><span class="pre">parse_mta_sts_record()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.mta_sts.query_mta_sts_record"><code class="docutils literal notranslate"><span class="pre">query_mta_sts_record()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#checkdmarc-smtp-tls-reporting">checkdmarc.smtp_tls_reporting</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-checkdmarc.spf">checkdmarc.spf</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.spf.MultipleSPFRTXTRecords"><code class="docutils literal notranslate"><span class="pre">MultipleSPFRTXTRecords</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.spf.SPFError"><code class="docutils literal notranslate"><span class="pre">SPFError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.spf.SPFIncludeLoop"><code class="docutils literal notranslate"><span class="pre">SPFIncludeLoop</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.spf.SPFRecordNotFound"><code class="docutils literal notranslate"><span class="pre">SPFRecordNotFound</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.spf.SPFRedirectLoop"><code class="docutils literal notranslate"><span class="pre">SPFRedirectLoop</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.spf.SPFSyntaxError"><code class="docutils literal notranslate"><span class="pre">SPFSyntaxError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.spf.SPFTooManyDNSLookups"><code class="docutils literal notranslate"><span class="pre">SPFTooManyDNSLookups</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.spf.SPFTooManyVoidDNSLookups"><code class="docutils literal notranslate"><span class="pre">SPFTooManyVoidDNSLookups</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.spf.check_spf"><code class="docutils literal notranslate"><span class="pre">check_spf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.spf.get_spf_record"><code class="docutils literal notranslate"><span class="pre">get_spf_record()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.spf.parse_spf_record"><code class="docutils literal notranslate"><span class="pre">parse_spf_record()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.spf.query_spf_record"><code class="docutils literal notranslate"><span class="pre">query_spf_record()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-checkdmarc.utils">checkdmarc.utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.utils.DNSException"><code class="docutils literal notranslate"><span class="pre">DNSException</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.utils.DNSExceptionNXDOMAIN"><code class="docutils literal notranslate"><span class="pre">DNSExceptionNXDOMAIN</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.utils.get_a_records"><code class="docutils literal notranslate"><span class="pre">get_a_records()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.utils.get_base_domain"><code class="docutils literal notranslate"><span class="pre">get_base_domain()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.utils.get_mx_records"><code class="docutils literal notranslate"><span class="pre">get_mx_records()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.utils.get_nameservers"><code class="docutils literal notranslate"><span class="pre">get_nameservers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.utils.get_reverse_dns"><code class="docutils literal notranslate"><span class="pre">get_reverse_dns()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.utils.get_txt_records"><code class="docutils literal notranslate"><span class="pre">get_txt_records()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkdmarc.utils.query_dns"><code class="docutils literal notranslate"><span class="pre">query_dns()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">CLI</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">checkdmarc</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">API</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/api.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="api">
<h1>API<a class="headerlink" href="#api" title="Link to this heading"></a></h1>
<section id="module-checkdmarc">
<span id="checkdmarc"></span><h2>checkdmarc<a class="headerlink" href="#module-checkdmarc" title="Link to this heading"></a></h2>
<p>Validates and parses email-related DNS records</p>
<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.check_domains">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.</span></span><span class="sig-name descname"><span class="pre">check_domains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domains</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parked</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approved_nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approved_mx_hostnames</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_tls</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bimi_selector</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_tag_descriptions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Resolver</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wait</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OrderedDict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">OrderedDict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/checkdmarc.html#check_domains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.check_domains" title="Link to this definition"></a></dt>
<dd><p>Check the given domains for SPF and DMARC records, parse them, and return
them</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domains</strong> (<em>list</em>) – A list of domains to check</p></li>
<li><p><strong>parked</strong> (<em>bool</em>) – Indicates that the domains are parked</p></li>
<li><p><strong>approved_nameservers</strong> (<em>list</em>) – A list of approved nameservers</p></li>
<li><p><strong>approved_mx_hostnames</strong> (<em>list</em>) – A list of approved MX hostname</p></li>
<li><p><strong>skip_tls</strong> (<em>bool</em>) – Skip STARTTLS testing</p></li>
<li><p><strong>bimi_selector</strong> (<em>str</em>) – The BIMI selector to test</p></li>
<li><p><strong>include_tag_descriptions</strong> (<em>bool</em>) – Include descriptions of
tags and/or tag values in the
results</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of nameservers to query</p></li>
<li><p><strong>resolver</strong> (<em>dns.resolver.Resolver</em>) – A resolver object to use for DNS
requests</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – number of seconds to wait for an answer from DNS</p></li>
<li><p><strong>wait</strong> (<em>float</em>) – number of seconds to wait between processing domains</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>An <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code> of  <cite>OrderedDict</cite> with the following keys</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">domain</span></code> - The domain name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">base_domain</span></code> The base domain</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mx</span></code> - See <code class="xref py py-func docutils literal notranslate"><span class="pre">checkdmarc.smtp.get_mx_hosts()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spf</span></code> -  A <code class="docutils literal notranslate"><span class="pre">valid</span></code> flag, plus the output of
<a class="reference internal" href="#checkdmarc.spf.parse_spf_record" title="checkdmarc.spf.parse_spf_record"><code class="xref py py-func docutils literal notranslate"><span class="pre">checkdmarc.spf.parse_spf_record()</span></code></a> or an <code class="docutils literal notranslate"><span class="pre">error</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dmarc</span></code> - A <code class="docutils literal notranslate"><span class="pre">valid</span></code> flag, plus the output of
<a class="reference internal" href="#checkdmarc.dmarc.parse_dmarc_record" title="checkdmarc.dmarc.parse_dmarc_record"><code class="xref py py-func docutils literal notranslate"><span class="pre">checkdmarc.dmarc.parse_dmarc_record()</span></code></a> or an <code class="docutils literal notranslate"><span class="pre">error</span></code></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.check_ns">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.</span></span><span class="sig-name descname"><span class="pre">check_ns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approved_nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Resolver</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OrderedDict</span></span></span><a class="reference internal" href="_modules/checkdmarc.html#check_ns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.check_ns" title="Link to this definition"></a></dt>
<dd><p>Returns a dictionary of nameservers and warnings or a dictionary with an
empty list and an error.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<em>str</em>) – A domain name</p></li>
<li><p><strong>approved_nameservers</strong> (<em>list</em>) – A list of approved nameserver substrings</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of nameservers to query</p></li>
<li><p><strong>resolver</strong> (<em>dns.resolver.Resolver</em>) – A resolver object to use for DNS
requests</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – number of seconds to wait for a record from DNS</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A dictionary with the following keys:</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">hostnames</span></code> - A list of nameserver hostnames</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warnings</span></code>  - A list of warnings</p></li>
</ul>
</div></blockquote>
<p>If a DNS error occurs, the dictionary will have the following
keys:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">hostnames</span></code> - An empty list</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">error</span></code>  - An error message</p></li>
</ul>
</div></blockquote>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OrderedDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.output_to_file">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.</span></span><span class="sig-name descname"><span class="pre">output_to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">content</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc.html#output_to_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.output_to_file" title="Link to this definition"></a></dt>
<dd><p>Write given content to the given path</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>) – A file path</p></li>
<li><p><strong>content</strong> (<em>str</em>) – JSON or CSV text</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.results_to_csv">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.</span></span><span class="sig-name descname"><span class="pre">results_to_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/checkdmarc.html#results_to_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.results_to_csv" title="Link to this definition"></a></dt>
<dd><p>Converts a dictionary of results to CSV</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>results</strong> (<em>dict</em>) – A dictionary of results</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A CSV of results</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.results_to_csv_rows">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.</span></span><span class="sig-name descname"><span class="pre">results_to_csv_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/checkdmarc.html#results_to_csv_rows"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.results_to_csv_rows" title="Link to this definition"></a></dt>
<dd><p>Converts a results dictionary or list of dictionaries and returns a
list of CSV row dictionaries</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>results</strong> (<em>dict</em>) – A dictionary of results</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of CSV row dictionaries</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.results_to_json">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.</span></span><span class="sig-name descname"><span class="pre">results_to_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/checkdmarc.html#results_to_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.results_to_json" title="Link to this definition"></a></dt>
<dd><p>Converts a dictionary of results or list of results to a JSON string</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>results</strong> (<em>dict</em>) – A dictionary of results</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Results in JSON format</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-checkdmarc.bimi">
<span id="checkdmarc-bimi"></span><h2>checkdmarc.bimi<a class="headerlink" href="#module-checkdmarc.bimi" title="Link to this heading"></a></h2>
<p>Brand Indicators for Message Identification (BIMI) record validation</p>
<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.bimi.BIMIError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.bimi.</span></span><span class="sig-name descname"><span class="pre">BIMIError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/bimi.html#BIMIError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.bimi.BIMIError" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.bimi.BIMIRecordInWrongLocation">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.bimi.</span></span><span class="sig-name descname"><span class="pre">BIMIRecordInWrongLocation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/bimi.html#BIMIRecordInWrongLocation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.bimi.BIMIRecordInWrongLocation" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.bimi.BIMIRecordNotFound">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.bimi.</span></span><span class="sig-name descname"><span class="pre">BIMIRecordNotFound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/bimi.html#BIMIRecordNotFound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.bimi.BIMIRecordNotFound" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.bimi.BIMISyntaxError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.bimi.</span></span><span class="sig-name descname"><span class="pre">BIMISyntaxError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/bimi.html#BIMISyntaxError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.bimi.BIMISyntaxError" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.bimi.InvalidBIMIIndicatorURI">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.bimi.</span></span><span class="sig-name descname"><span class="pre">InvalidBIMIIndicatorURI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/bimi.html#InvalidBIMIIndicatorURI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.bimi.InvalidBIMIIndicatorURI" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.bimi.InvalidBIMITag">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.bimi.</span></span><span class="sig-name descname"><span class="pre">InvalidBIMITag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/bimi.html#InvalidBIMITag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.bimi.InvalidBIMITag" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.bimi.InvalidBIMITagValue">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.bimi.</span></span><span class="sig-name descname"><span class="pre">InvalidBIMITagValue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/bimi.html#InvalidBIMITagValue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.bimi.InvalidBIMITagValue" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.bimi.MultipleBIMIRecords">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.bimi.</span></span><span class="sig-name descname"><span class="pre">MultipleBIMIRecords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/bimi.html#MultipleBIMIRecords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.bimi.MultipleBIMIRecords" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.bimi.SPFRecordFoundWhereBIMIRecordShouldBe">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.bimi.</span></span><span class="sig-name descname"><span class="pre">SPFRecordFoundWhereBIMIRecordShouldBe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/bimi.html#SPFRecordFoundWhereBIMIRecordShouldBe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.bimi.SPFRecordFoundWhereBIMIRecordShouldBe" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.bimi.UnrelatedTXTRecordFoundAtBIMI">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.bimi.</span></span><span class="sig-name descname"><span class="pre">UnrelatedTXTRecordFoundAtBIMI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/bimi.html#UnrelatedTXTRecordFoundAtBIMI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.bimi.UnrelatedTXTRecordFoundAtBIMI" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.bimi.check_bimi">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.bimi.</span></span><span class="sig-name descname"><span class="pre">check_bimi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selector</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_tag_descriptions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Resolver</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OrderedDict</span></span></span><a class="reference internal" href="_modules/checkdmarc/bimi.html#check_bimi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.bimi.check_bimi" title="Link to this definition"></a></dt>
<dd><p>Returns a dictionary with a parsed BIMI record or an error.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will attempt to download the files at the URLs provided in
the BIMI record and will include a warning if the downloads fail,
but the file content is not currently analyzed.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<em>str</em>) – A domain name</p></li>
<li><p><strong>selector</strong> (<em>str</em>) – The BIMI selector</p></li>
<li><p><strong>include_tag_descriptions</strong> (<em>bool</em>) – Include descriptions in parsed results</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of nameservers to query</p></li>
<li><p><strong>resolver</strong> (<em>dns.resolver.Resolver</em>) – A resolver object to use for DNS
requests</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – number of seconds to wait for an answer from DNS</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>An <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> with the following keys:</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">record</span></code> - The BIMI record string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parsed</span></code> - The parsed BIMI record</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">valid</span></code> - True</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warnings</span></code> - A <code class="docutils literal notranslate"><span class="pre">list</span></code> of warnings</p></li>
</ul>
</div></blockquote>
<p>If a DNS error occurs, the dictionary will have the
following keys:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">error</span></code> - Tne error message</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">valid</span></code> - False</p></li>
</ul>
</div></blockquote>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OrderedDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.bimi.parse_bimi_record">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.bimi.</span></span><span class="sig-name descname"><span class="pre">parse_bimi_record</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_tag_descriptions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">syntax_error_marker</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'➞'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OrderedDict</span></span></span><a class="reference internal" href="_modules/checkdmarc/bimi.html#parse_bimi_record"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.bimi.parse_bimi_record" title="Link to this definition"></a></dt>
<dd><p>Parses a BIMI record</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>record</strong> (<em>str</em>) – A BIMI record</p></li>
<li><p><strong>include_tag_descriptions</strong> (<em>bool</em>) – Include descriptions in parsed results</p></li>
<li><p><strong>syntax_error_marker</strong> (<em>str</em>) – The maker for pointing out syntax errors</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>An <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> with the following keys:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tags</span></code> - An <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> of BIMI tags</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">value</span></code> - The BIMI tag value</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">description</span></code> - A description of the tag/value</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">warnings</span></code> - A <code class="docutils literal notranslate"><span class="pre">list</span></code> of warnings</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<blockquote>
<div><p>This will attempt to download the files at the URLs provided in
the BIMI record and will include a warning if the downloads fail,
but the file content is not currently analyzed.</p>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">description</span></code> is only included if
<code class="docutils literal notranslate"><span class="pre">include_tag_descriptions</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</div>
</div>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OrderedDict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="#checkdmarc.bimi.BIMISyntaxError" title="checkdmarc.bimi.BIMISyntaxError"><strong>checkdmarc.bimi.BIMISyntaxError</strong></a> – </p></li>
<li><p><a class="reference internal" href="#checkdmarc.bimi.InvalidBIMITag" title="checkdmarc.bimi.InvalidBIMITag"><strong>checkdmarc.bimi.InvalidBIMITag</strong></a> – </p></li>
<li><p><a class="reference internal" href="#checkdmarc.bimi.InvalidBIMITagValue" title="checkdmarc.bimi.InvalidBIMITagValue"><strong>checkdmarc.bimi.InvalidBIMITagValue</strong></a> – </p></li>
<li><p><a class="reference internal" href="#checkdmarc.bimi.SPFRecordFoundWhereBIMIRecordShouldBe" title="checkdmarc.bimi.SPFRecordFoundWhereBIMIRecordShouldBe"><strong>checkdmarc.bimi.SPFRecordFoundWhereBIMIRecordShouldBe</strong></a> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.bimi.query_bimi_record">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.bimi.</span></span><span class="sig-name descname"><span class="pre">query_bimi_record</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selector</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Resolver</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OrderedDict</span></span></span><a class="reference internal" href="_modules/checkdmarc/bimi.html#query_bimi_record"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.bimi.query_bimi_record" title="Link to this definition"></a></dt>
<dd><p>Queries DNS for a BIMI record</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<em>str</em>) – A domain name</p></li>
<li><p><strong>selector</strong> (<em>str</em>) – The BMI selector</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of nameservers to query</p></li>
<li><p><strong>resolver</strong> (<em>dns.resolver.Resolver</em>) – A resolver object to use for DNS
requests</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – number of seconds to wait for a record from DNS</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>An <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> with the following keys:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">record</span></code> - the unparsed BIMI record string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">location</span></code> - the domain where the record was found</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warnings</span></code> - warning conditions found</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>OrderedDict</p>
<dl class="simple">
<dt>Raises:</dt><dd><p><a class="reference internal" href="#checkdmarc.bimi.BIMIRecordNotFound" title="checkdmarc.bimi.BIMIRecordNotFound"><code class="xref py py-exc docutils literal notranslate"><span class="pre">checkdmarc.bimi.BIMIRecordNotFound</span></code></a>
<a class="reference internal" href="#checkdmarc.bimi.BIMIRecordInWrongLocation" title="checkdmarc.bimi.BIMIRecordInWrongLocation"><code class="xref py py-exc docutils literal notranslate"><span class="pre">checkdmarc.bimi.BIMIRecordInWrongLocation</span></code></a>
<a class="reference internal" href="#checkdmarc.bimi.MultipleBIMIRecords" title="checkdmarc.bimi.MultipleBIMIRecords"><code class="xref py py-exc docutils literal notranslate"><span class="pre">checkdmarc.bimi.MultipleBIMIRecords</span></code></a></p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-checkdmarc.dmarc">
<span id="checkdmarc-dmarc"></span><h2>checkdmarc.dmarc<a class="headerlink" href="#module-checkdmarc.dmarc" title="Link to this heading"></a></h2>
<p>DMARC record validation</p>
<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.dmarc.DMARCError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.dmarc.</span></span><span class="sig-name descname"><span class="pre">DMARCError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/dmarc.html#DMARCError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.dmarc.DMARCError" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.dmarc.DMARCRecordInWrongLocation">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.dmarc.</span></span><span class="sig-name descname"><span class="pre">DMARCRecordInWrongLocation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/dmarc.html#DMARCRecordInWrongLocation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.dmarc.DMARCRecordInWrongLocation" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.dmarc.DMARCRecordNotFound">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.dmarc.</span></span><span class="sig-name descname"><span class="pre">DMARCRecordNotFound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/dmarc.html#DMARCRecordNotFound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.dmarc.DMARCRecordNotFound" title="Link to this definition"></a></dt>
<dd><p>Raised when a DMARC record could not be found</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.dmarc.DMARCRecordStartsWithWhitespace">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.dmarc.</span></span><span class="sig-name descname"><span class="pre">DMARCRecordStartsWithWhitespace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/dmarc.html#DMARCRecordStartsWithWhitespace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.dmarc.DMARCRecordStartsWithWhitespace" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.dmarc.DMARCReportEmailAddressMissingMXRecords">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.dmarc.</span></span><span class="sig-name descname"><span class="pre">DMARCReportEmailAddressMissingMXRecords</span></span><a class="reference internal" href="_modules/checkdmarc/dmarc.html#DMARCReportEmailAddressMissingMXRecords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.dmarc.DMARCReportEmailAddressMissingMXRecords" title="Link to this definition"></a></dt>
<dd><p>Raised when an email address in a DMARC report URI is missing MX
records</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.dmarc.DMARCSyntaxError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.dmarc.</span></span><span class="sig-name descname"><span class="pre">DMARCSyntaxError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/dmarc.html#DMARCSyntaxError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.dmarc.DMARCSyntaxError" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.dmarc.InvalidDMARCReportURI">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.dmarc.</span></span><span class="sig-name descname"><span class="pre">InvalidDMARCReportURI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/dmarc.html#InvalidDMARCReportURI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.dmarc.InvalidDMARCReportURI" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.dmarc.InvalidDMARCTag">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.dmarc.</span></span><span class="sig-name descname"><span class="pre">InvalidDMARCTag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/dmarc.html#InvalidDMARCTag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.dmarc.InvalidDMARCTag" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.dmarc.InvalidDMARCTagValue">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.dmarc.</span></span><span class="sig-name descname"><span class="pre">InvalidDMARCTagValue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/dmarc.html#InvalidDMARCTagValue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.dmarc.InvalidDMARCTagValue" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.dmarc.MultipleDMARCRecords">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.dmarc.</span></span><span class="sig-name descname"><span class="pre">MultipleDMARCRecords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/dmarc.html#MultipleDMARCRecords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.dmarc.MultipleDMARCRecords" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.dmarc.SPFRecordFoundWhereDMARCRecordShouldBe">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.dmarc.</span></span><span class="sig-name descname"><span class="pre">SPFRecordFoundWhereDMARCRecordShouldBe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/dmarc.html#SPFRecordFoundWhereDMARCRecordShouldBe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.dmarc.SPFRecordFoundWhereDMARCRecordShouldBe" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.dmarc.UnrelatedTXTRecordFoundAtDMARC">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.dmarc.</span></span><span class="sig-name descname"><span class="pre">UnrelatedTXTRecordFoundAtDMARC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/dmarc.html#UnrelatedTXTRecordFoundAtDMARC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.dmarc.UnrelatedTXTRecordFoundAtDMARC" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.dmarc.UnverifiedDMARCURIDestination">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.dmarc.</span></span><span class="sig-name descname"><span class="pre">UnverifiedDMARCURIDestination</span></span><a class="reference internal" href="_modules/checkdmarc/dmarc.html#UnverifiedDMARCURIDestination"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.dmarc.UnverifiedDMARCURIDestination" title="Link to this definition"></a></dt>
<dd><p>Raised when the destination of a DMARC report URI does not indicate
that it accepts reports for the domain</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.dmarc.check_dmarc">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.dmarc.</span></span><span class="sig-name descname"><span class="pre">check_dmarc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parked</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_dmarc_tag_descriptions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_unrelated_records</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Resolver</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OrderedDict</span></span></span><a class="reference internal" href="_modules/checkdmarc/dmarc.html#check_dmarc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.dmarc.check_dmarc" title="Link to this definition"></a></dt>
<dd><p>Returns a dictionary with a parsed DMARC record or an error</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<em>str</em>) – A domain name</p></li>
<li><p><strong>parked</strong> (<em>bool</em>) – The domain is parked</p></li>
<li><p><strong>include_dmarc_tag_descriptions</strong> (<em>bool</em>) – Include tag descriptions</p></li>
<li><p><strong>ignore_unrelated_records</strong> (<em>bool</em>) – Ignore unrelated TXT records</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of nameservers to query</p></li>
<li><p><strong>resolver</strong> (<em>dns.resolver.Resolver</em>) – A resolver object to use for DNS
requests</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – number of seconds to wait for a record from DNS</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>An <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> with the following keys:</p>
<blockquote>
<div><blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">record</span></code> - the unparsed DMARC record string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">location</span></code> - the domain where the record was found</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warnings</span></code> - warning conditions found</p></li>
</ul>
</div></blockquote>
<p>If a DNS error occurs, the dictionary will have the
following keys:</p>
</div></blockquote>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">error</span></code>  - An error message</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">valid</span></code> - False</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OrderedDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.dmarc.check_wildcard_dmarc_report_authorization">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.dmarc.</span></span><span class="sig-name descname"><span class="pre">check_wildcard_dmarc_report_authorization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Resolver</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/checkdmarc/dmarc.html#check_wildcard_dmarc_report_authorization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.dmarc.check_wildcard_dmarc_report_authorization" title="Link to this definition"></a></dt>
<dd><p>Checks for a wildcard DMARC report authorization record, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*.</span><span class="n">_report</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="n">IN</span> <span class="n">TXT</span> <span class="s2">&quot;v=DMARC1&quot;</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<em>str</em>) – The domain to check</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of nameservers to query</p></li>
<li><p><strong>resolver</strong> (<em>dns.resolver.Resolver</em>) – A resolver object to use for DNS
requests</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – number of seconds to wait for an answer from DNS</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An indicator of the existence of a valid wildcard DMARC report
authorization record</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.dmarc.get_dmarc_record">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.dmarc.</span></span><span class="sig-name descname"><span class="pre">get_dmarc_record</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_tag_descriptions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Resolver</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OrderedDict</span></span></span><a class="reference internal" href="_modules/checkdmarc/dmarc.html#get_dmarc_record"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.dmarc.get_dmarc_record" title="Link to this definition"></a></dt>
<dd><p>Retrieves a DMARC record for a domain and parses it</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<em>str</em>) – A domain name</p></li>
<li><p><strong>include_tag_descriptions</strong> (<em>bool</em>) – Include descriptions in parsed results</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of nameservers to query</p></li>
<li><p><strong>resolver</strong> (<em>dns.resolver.Resolver</em>) – A resolver object to use for DNS
requests</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – number of seconds to wait for an answer from DNS</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>An <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> with the following keys:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">record</span></code> - The DMARC record string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">location</span></code> -  Where the DMARC was found</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parsed</span></code> - See <code class="xref py py-meth docutils literal notranslate"><span class="pre">checkdmarc.parse_dmarc_record()</span></code></p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>OrderedDict</p>
<dl class="simple">
<dt>Raises:</dt><dd><p><a class="reference internal" href="#checkdmarc.dmarc.DMARCRecordNotFound" title="checkdmarc.dmarc.DMARCRecordNotFound"><code class="xref py py-exc docutils literal notranslate"><span class="pre">checkdmarc.dmarc.DMARCRecordNotFound</span></code></a>
<a class="reference internal" href="#checkdmarc.dmarc.DMARCRecordInWrongLocation" title="checkdmarc.dmarc.DMARCRecordInWrongLocation"><code class="xref py py-exc docutils literal notranslate"><span class="pre">checkdmarc.dmarc.DMARCRecordInWrongLocation</span></code></a>
<a class="reference internal" href="#checkdmarc.dmarc.MultipleDMARCRecords" title="checkdmarc.dmarc.MultipleDMARCRecords"><code class="xref py py-exc docutils literal notranslate"><span class="pre">checkdmarc.dmarc.MultipleDMARCRecords</span></code></a>
<a class="reference internal" href="#checkdmarc.dmarc.SPFRecordFoundWhereDMARCRecordShouldBe" title="checkdmarc.dmarc.SPFRecordFoundWhereDMARCRecordShouldBe"><code class="xref py py-exc docutils literal notranslate"><span class="pre">checkdmarc.dmarc.SPFRecordFoundWhereDMARCRecordShouldBe</span></code></a>
<a class="reference internal" href="#checkdmarc.dmarc.UnverifiedDMARCURIDestination" title="checkdmarc.dmarc.UnverifiedDMARCURIDestination"><code class="xref py py-exc docutils literal notranslate"><span class="pre">checkdmarc.dmarc.UnverifiedDMARCURIDestination</span></code></a>
<a class="reference internal" href="#checkdmarc.dmarc.DMARCSyntaxError" title="checkdmarc.dmarc.DMARCSyntaxError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">checkdmarc.dmarc.DMARCSyntaxError</span></code></a>
<a class="reference internal" href="#checkdmarc.dmarc.InvalidDMARCTag" title="checkdmarc.dmarc.InvalidDMARCTag"><code class="xref py py-exc docutils literal notranslate"><span class="pre">checkdmarc.dmarc.InvalidDMARCTag</span></code></a>
<a class="reference internal" href="#checkdmarc.dmarc.InvalidDMARCTagValue" title="checkdmarc.dmarc.InvalidDMARCTagValue"><code class="xref py py-exc docutils literal notranslate"><span class="pre">checkdmarc.dmarc.InvalidDMARCTagValue</span></code></a>
<a class="reference internal" href="#checkdmarc.dmarc.InvalidDMARCReportURI" title="checkdmarc.dmarc.InvalidDMARCReportURI"><code class="xref py py-exc docutils literal notranslate"><span class="pre">checkdmarc.dmarc.InvalidDMARCReportURI</span></code></a>
<a class="reference internal" href="#checkdmarc.dmarc.UnverifiedDMARCURIDestination" title="checkdmarc.dmarc.UnverifiedDMARCURIDestination"><code class="xref py py-exc docutils literal notranslate"><span class="pre">checkdmarc.dmarc.UnverifiedDMARCURIDestination</span></code></a>
<code class="xref py py-exc docutils literal notranslate"><span class="pre">checkdmarc.dmarc.UnrelatedTXTRecordFound</span></code>
<a class="reference internal" href="#checkdmarc.dmarc.DMARCReportEmailAddressMissingMXRecords" title="checkdmarc.dmarc.DMARCReportEmailAddressMissingMXRecords"><code class="xref py py-exc docutils literal notranslate"><span class="pre">checkdmarc.dmarc.DMARCReportEmailAddressMissingMXRecords</span></code></a></p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.dmarc.get_dmarc_tag_description">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.dmarc.</span></span><span class="sig-name descname"><span class="pre">get_dmarc_tag_description</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OrderedDict</span></span></span><a class="reference internal" href="_modules/checkdmarc/dmarc.html#get_dmarc_tag_description"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.dmarc.get_dmarc_tag_description" title="Link to this definition"></a></dt>
<dd><p>Get the name, default value, and description for a DMARC tag, amd/or a
description for a tag value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tag</strong> (<em>str</em>) – A DMARC tag</p></li>
<li><p><strong>value</strong> – An optional value</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>An <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> with the following keys:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - the tag name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">default</span></code>- the tag’s default value</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">description</span></code> - A description of the tag or value</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OrderedDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.dmarc.parse_dmarc_record">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.dmarc.</span></span><span class="sig-name descname"><span class="pre">parse_dmarc_record</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parked</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_tag_descriptions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Resolver</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">syntax_error_marker</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'➞'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OrderedDict</span></span></span><a class="reference internal" href="_modules/checkdmarc/dmarc.html#parse_dmarc_record"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.dmarc.parse_dmarc_record" title="Link to this definition"></a></dt>
<dd><p>Parses a DMARC record</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>record</strong> (<em>str</em>) – A DMARC record</p></li>
<li><p><strong>domain</strong> (<em>str</em>) – The domain where the record is found</p></li>
<li><p><strong>parked</strong> (<em>bool</em>) – Indicates if a domain is parked</p></li>
<li><p><strong>include_tag_descriptions</strong> (<em>bool</em>) – Include descriptions in parsed results</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of nameservers to query</p></li>
<li><p><strong>resolver</strong> (<em>dns.resolver.Resolver</em>) – A resolver object to use for DNS
requests</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – number of seconds to wait for an answer from DNS</p></li>
<li><p><strong>syntax_error_marker</strong> (<em>str</em>) – The maker for pointing out syntax errors</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl>
<dt>An <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> with the following keys:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tags</span></code> - An <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> of DMARC tags</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">value</span></code> - The DMARC tag value</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">explicit</span></code> - <code class="docutils literal notranslate"><span class="pre">bool</span></code>: A value is explicitly set</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">default</span></code> - The tag’s default value</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">description</span></code> - A description of the tag/value</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">warnings</span></code> - A <code class="docutils literal notranslate"><span class="pre">list</span></code> of warnings</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">default</span></code> and <code class="docutils literal notranslate"><span class="pre">description</span></code> are only included if
<code class="docutils literal notranslate"><span class="pre">include_tag_descriptions</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</div>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OrderedDict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="#checkdmarc.dmarc.DMARCSyntaxError" title="checkdmarc.dmarc.DMARCSyntaxError"><strong>checkdmarc.dmarc.DMARCSyntaxError</strong></a> – </p></li>
<li><p><a class="reference internal" href="#checkdmarc.dmarc.InvalidDMARCTag" title="checkdmarc.dmarc.InvalidDMARCTag"><strong>checkdmarc.dmarc.InvalidDMARCTag</strong></a> – </p></li>
<li><p><a class="reference internal" href="#checkdmarc.dmarc.InvalidDMARCTagValue" title="checkdmarc.dmarc.InvalidDMARCTagValue"><strong>checkdmarc.dmarc.InvalidDMARCTagValue</strong></a> – </p></li>
<li><p><a class="reference internal" href="#checkdmarc.dmarc.InvalidDMARCReportURI" title="checkdmarc.dmarc.InvalidDMARCReportURI"><strong>checkdmarc.dmarc.InvalidDMARCReportURI</strong></a> – </p></li>
<li><p><a class="reference internal" href="#checkdmarc.dmarc.UnverifiedDMARCURIDestination" title="checkdmarc.dmarc.UnverifiedDMARCURIDestination"><strong>checkdmarc.dmarc.UnverifiedDMARCURIDestination</strong></a> – </p></li>
<li><p><strong>checkdmarc.dmarc.UnrelatedTXTRecordFound</strong> – </p></li>
<li><p><a class="reference internal" href="#checkdmarc.dmarc.DMARCReportEmailAddressMissingMXRecords" title="checkdmarc.dmarc.DMARCReportEmailAddressMissingMXRecords"><strong>checkdmarc.dmarc.DMARCReportEmailAddressMissingMXRecords</strong></a> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.dmarc.parse_dmarc_report_uri">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.dmarc.</span></span><span class="sig-name descname"><span class="pre">parse_dmarc_report_uri</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uri</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OrderedDict</span></span></span><a class="reference internal" href="_modules/checkdmarc/dmarc.html#parse_dmarc_report_uri"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.dmarc.parse_dmarc_report_uri" title="Link to this definition"></a></dt>
<dd><p>Parses a DMARC Reporting (i.e. <code class="docutils literal notranslate"><span class="pre">rua</span></code>/<code class="docutils literal notranslate"><span class="pre">ruf</span></code>) URI</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">mailto</span></code> is the only reporting URI scheme supported in DMARC1</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>uri</strong> – A DMARC URI</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>An <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> of the URI’s components:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">scheme</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">address</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">size_limit</span></code></p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OrderedDict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#checkdmarc.dmarc.InvalidDMARCReportURI" title="checkdmarc.dmarc.InvalidDMARCReportURI"><strong>checkdmarc.dmarc.InvalidDMARCReportURI</strong></a> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.dmarc.query_dmarc_record">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.dmarc.</span></span><span class="sig-name descname"><span class="pre">query_dmarc_record</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Resolver</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_unrelated_records</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OrderedDict</span></span></span><a class="reference internal" href="_modules/checkdmarc/dmarc.html#query_dmarc_record"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.dmarc.query_dmarc_record" title="Link to this definition"></a></dt>
<dd><p>Queries DNS for a DMARC record</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<em>str</em>) – A domain name</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of nameservers to query</p></li>
<li><p><strong>resolver</strong> (<em>dns.resolver.Resolver</em>) – A resolver object to use for DNS
requests</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – number of seconds to wait for a record from DNS</p></li>
<li><p><strong>ignore_unrelated_records</strong> (<em>bool</em>) – Ignore unrelated TXT records</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>An <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> with the following keys:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">record</span></code> - the unparsed DMARC record string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">location</span></code> - the domain where the record was found</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warnings</span></code> - warning conditions found</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>OrderedDict</p>
<dl class="simple">
<dt>Raises:</dt><dd><p><a class="reference internal" href="#checkdmarc.dmarc.DMARCRecordNotFound" title="checkdmarc.dmarc.DMARCRecordNotFound"><code class="xref py py-exc docutils literal notranslate"><span class="pre">checkdmarc.dmarc.DMARCRecordNotFound</span></code></a>
<a class="reference internal" href="#checkdmarc.dmarc.DMARCRecordInWrongLocation" title="checkdmarc.dmarc.DMARCRecordInWrongLocation"><code class="xref py py-exc docutils literal notranslate"><span class="pre">checkdmarc.dmarc.DMARCRecordInWrongLocation</span></code></a>
<a class="reference internal" href="#checkdmarc.dmarc.MultipleDMARCRecords" title="checkdmarc.dmarc.MultipleDMARCRecords"><code class="xref py py-exc docutils literal notranslate"><span class="pre">checkdmarc.dmarc.MultipleDMARCRecords</span></code></a>
<a class="reference internal" href="#checkdmarc.dmarc.SPFRecordFoundWhereDMARCRecordShouldBe" title="checkdmarc.dmarc.SPFRecordFoundWhereDMARCRecordShouldBe"><code class="xref py py-exc docutils literal notranslate"><span class="pre">checkdmarc.dmarc.SPFRecordFoundWhereDMARCRecordShouldBe</span></code></a></p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.dmarc.verify_dmarc_report_destination">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.dmarc.</span></span><span class="sig-name descname"><span class="pre">verify_dmarc_report_destination</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">destination_domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Resolver</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/checkdmarc/dmarc.html#verify_dmarc_report_destination"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.dmarc.verify_dmarc_report_destination" title="Link to this definition"></a></dt>
<dd><p>Checks if the report destination accepts reports for the source domain
per RFC 7489, section 7.1</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_domain</strong> (<em>str</em>) – The source domain</p></li>
<li><p><strong>destination_domain</strong> (<em>str</em>) – The destination domain</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of nameservers to query</p></li>
<li><p><strong>resolver</strong> – A resolver object to use for DNS
requests</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Indicates if the report domain accepts reports from the given
domain</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="#checkdmarc.dmarc.UnverifiedDMARCURIDestination" title="checkdmarc.dmarc.UnverifiedDMARCURIDestination"><strong>checkdmarc.dmarc.UnverifiedDMARCURIDestination</strong></a> – </p></li>
<li><p><strong>checkdmarc.dmarc.UnrelatedTXTRecordFound</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-checkdmarc.dnssec">
<span id="checkdmarc-dnssec"></span><h2>checkdmarc.dnssec<a class="headerlink" href="#module-checkdmarc.dnssec" title="Link to this heading"></a></h2>
<p>DNSSEC tests</p>
<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.dnssec.get_dnskey">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.dnssec.</span></span><span class="sig-name descname"><span class="pre">get_dnskey</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ExpiringDict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/dnssec.html#get_dnskey"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.dnssec.get_dnskey" title="Link to this definition"></a></dt>
<dd><p>Get a DNSKEY RRSet on the given domain</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<em>str</em>) – The domain to check</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of nameservers to query</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – Timeout in seconds</p></li>
<li><p><strong>cache</strong> (<em>ExpiringDict</em>) – A cache</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DNSKEY dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.dnssec.get_tlsa_records">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.dnssec.</span></span><span class="sig-name descname"><span class="pre">get_tlsa_records</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hostname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">protocol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'tcp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ExpiringDict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/checkdmarc/dnssec.html#get_tlsa_records"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.dnssec.get_tlsa_records" title="Link to this definition"></a></dt>
<dd><p>Checks for TLSA records on the given hostname</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hostname</strong> (<em>str</em>) – The domain to check</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of nameservers to query</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – Timeout in seconds</p></li>
<li><p><strong>port</strong> (<em>int</em>) – The port</p></li>
<li><p><strong>protocol</strong> (<em>str</em>) – The protocol</p></li>
<li><p><strong>cache</strong> (<em>ExpiringDict</em>) – A cache</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of TLSA records</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.dnssec.test_dnssec">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.dnssec.</span></span><span class="sig-name descname"><span class="pre">test_dnssec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ExpiringDict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/checkdmarc/dnssec.html#test_dnssec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.dnssec.test_dnssec" title="Link to this definition"></a></dt>
<dd><p>Check for DNSSEC on the given domain</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<em>str</em>) – The domain to check</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of nameservers to query</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – Timeout in seconds</p></li>
<li><p><strong>cache</strong> (<em>ExpiringDict</em>) – Cache</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DNSSEC status</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-checkdmarc.mta_sts">
<span id="checkdmarc-mta-sts"></span><h2>checkdmarc.mta_sts<a class="headerlink" href="#module-checkdmarc.mta_sts" title="Link to this heading"></a></h2>
<p>SMTP MTA Strict Transport Security (MTA-STS) validation</p>
<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.mta_sts.InvalidMTASTSTag">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.mta_sts.</span></span><span class="sig-name descname"><span class="pre">InvalidMTASTSTag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/mta_sts.html#InvalidMTASTSTag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.mta_sts.InvalidMTASTSTag" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.mta_sts.InvalidSTSTagValue">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.mta_sts.</span></span><span class="sig-name descname"><span class="pre">InvalidSTSTagValue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/mta_sts.html#InvalidSTSTagValue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.mta_sts.InvalidSTSTagValue" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.mta_sts.MTASTSError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.mta_sts.</span></span><span class="sig-name descname"><span class="pre">MTASTSError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/mta_sts.html#MTASTSError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.mta_sts.MTASTSError" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.mta_sts.MTASTSPolicyDownloadError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.mta_sts.</span></span><span class="sig-name descname"><span class="pre">MTASTSPolicyDownloadError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/mta_sts.html#MTASTSPolicyDownloadError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.mta_sts.MTASTSPolicyDownloadError" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.mta_sts.MTASTSPolicyError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.mta_sts.</span></span><span class="sig-name descname"><span class="pre">MTASTSPolicyError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/mta_sts.html#MTASTSPolicyError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.mta_sts.MTASTSPolicyError" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.mta_sts.MTASTSPolicySyntaxError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.mta_sts.</span></span><span class="sig-name descname"><span class="pre">MTASTSPolicySyntaxError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/mta_sts.html#MTASTSPolicySyntaxError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.mta_sts.MTASTSPolicySyntaxError" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.mta_sts.MTASTSRecordInWrongLocation">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.mta_sts.</span></span><span class="sig-name descname"><span class="pre">MTASTSRecordInWrongLocation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/mta_sts.html#MTASTSRecordInWrongLocation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.mta_sts.MTASTSRecordInWrongLocation" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.mta_sts.MTASTSRecordNotFound">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.mta_sts.</span></span><span class="sig-name descname"><span class="pre">MTASTSRecordNotFound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/mta_sts.html#MTASTSRecordNotFound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.mta_sts.MTASTSRecordNotFound" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.mta_sts.MTASTSRecordSyntaxError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.mta_sts.</span></span><span class="sig-name descname"><span class="pre">MTASTSRecordSyntaxError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/mta_sts.html#MTASTSRecordSyntaxError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.mta_sts.MTASTSRecordSyntaxError" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.mta_sts.MultipleMTASTSRecords">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.mta_sts.</span></span><span class="sig-name descname"><span class="pre">MultipleMTASTSRecords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/mta_sts.html#MultipleMTASTSRecords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.mta_sts.MultipleMTASTSRecords" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.mta_sts.SPFRecordFoundWhereMTASTSRecordShouldBe">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.mta_sts.</span></span><span class="sig-name descname"><span class="pre">SPFRecordFoundWhereMTASTSRecordShouldBe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/mta_sts.html#SPFRecordFoundWhereMTASTSRecordShouldBe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.mta_sts.SPFRecordFoundWhereMTASTSRecordShouldBe" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.mta_sts.UnrelatedTXTRecordFoundAtMTASTS">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.mta_sts.</span></span><span class="sig-name descname"><span class="pre">UnrelatedTXTRecordFoundAtMTASTS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/mta_sts.html#UnrelatedTXTRecordFoundAtMTASTS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.mta_sts.UnrelatedTXTRecordFoundAtMTASTS" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.mta_sts.check_mta_sts">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.mta_sts.</span></span><span class="sig-name descname"><span class="pre">check_mta_sts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Resolver</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OrderedDict</span></span></span><a class="reference internal" href="_modules/checkdmarc/mta_sts.html#check_mta_sts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.mta_sts.check_mta_sts" title="Link to this definition"></a></dt>
<dd><p>Returns a dictionary with a parsed MTA-STS policy or an error.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<em>str</em>) – A domain name</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of nameservers to query</p></li>
<li><p><strong>resolver</strong> (<em>dns.resolver.Resolver</em>) – A resolver object to use for DNS
requests</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – number of seconds to wait for an answer from DNS</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>An <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> with the following keys:</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code> - The SIS-MTA DNS record ID</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">policy</span></code> - The parsed MTA-STS policy</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">valid</span></code> - True</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warnings</span></code> - A <code class="docutils literal notranslate"><span class="pre">list</span></code> of warnings</p></li>
</ul>
</div></blockquote>
<p>If an error occurs, the dictionary will have the
following keys:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">error</span></code> - Tne error message</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">valid</span></code> - False</p></li>
</ul>
</div></blockquote>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OrderedDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.mta_sts.download_mta_sts_policy">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.mta_sts.</span></span><span class="sig-name descname"><span class="pre">download_mta_sts_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OrderedDict</span></span></span><a class="reference internal" href="_modules/checkdmarc/mta_sts.html#download_mta_sts_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.mta_sts.download_mta_sts_policy" title="Link to this definition"></a></dt>
<dd><p>Downloads a domains MTA-HTS policy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>domain</strong> (<em>str</em>) – A domain name</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>An <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> with the following keys:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">policy</span></code> - The unparsed policy string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warnings</span></code> - A list of any warning conditions found</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OrderedDict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#checkdmarc.mta_sts.MTASTSPolicyDownloadError" title="checkdmarc.mta_sts.MTASTSPolicyDownloadError"><strong>checkdmarc.mta_sts.MTASTSPolicyDownloadError</strong></a> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.mta_sts.mx_in_mta_sts_patterns">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.mta_sts.</span></span><span class="sig-name descname"><span class="pre">mx_in_mta_sts_patterns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mx_hostname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mta_sts_mx_patterns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/checkdmarc/mta_sts.html#mx_in_mta_sts_patterns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.mta_sts.mx_in_mta_sts_patterns" title="Link to this definition"></a></dt>
<dd><p>Tests is a given MX hostname is covered by a given list of MX patterns
from an MTA-STS policy:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mx_hostname</strong> (<em>str</em>) – The MX hostname to test</p></li>
<li><p><strong>mta_sts_mx_patterns</strong> (<em>str</em>) – The list of MTA-STS MX patterns</p></li>
</ul>
</dd>
</dl>
<p>Returns: True if the MX hostname is included, false if not</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.mta_sts.parse_mta_sts_policy">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.mta_sts.</span></span><span class="sig-name descname"><span class="pre">parse_mta_sts_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OrderedDict</span></span></span><a class="reference internal" href="_modules/checkdmarc/mta_sts.html#parse_mta_sts_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.mta_sts.parse_mta_sts_policy" title="Link to this definition"></a></dt>
<dd><p>Parses an MTA-STS policy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>policy</strong> – The policy</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#checkdmarc.mta_sts.MTASTSPolicySyntaxError" title="checkdmarc.mta_sts.MTASTSPolicySyntaxError"><strong>checkdmarc.mta_sts.MTASTSPolicySyntaxError</strong></a> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.mta_sts.parse_mta_sts_record">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.mta_sts.</span></span><span class="sig-name descname"><span class="pre">parse_mta_sts_record</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_tag_descriptions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">syntax_error_marker</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'➞'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OrderedDict</span></span></span><a class="reference internal" href="_modules/checkdmarc/mta_sts.html#parse_mta_sts_record"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.mta_sts.parse_mta_sts_record" title="Link to this definition"></a></dt>
<dd><p>Parses an MTA-STS record</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>record</strong> (<em>str</em>) – A MTA-STS record</p></li>
<li><p><strong>include_tag_descriptions</strong> (<em>bool</em>) – Include descriptions in parsed results</p></li>
<li><p><strong>syntax_error_marker</strong> (<em>str</em>) – The maker for pointing out syntax errors</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl>
<dt>An <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> with the following keys:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tags</span></code> - An <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> of MTA-STS tags</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">value</span></code> - The MTA-STS tag value</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">description</span></code> - A description of the tag/value</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">warnings</span></code> - A <code class="docutils literal notranslate"><span class="pre">list</span></code> of warnings</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">description</span></code> is only included if
<code class="docutils literal notranslate"><span class="pre">include_tag_descriptions</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</div>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OrderedDict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>checkdmarc.mta_sts.MTASTSSyntaxError</strong> – </p></li>
<li><p><a class="reference internal" href="#checkdmarc.mta_sts.InvalidMTASTSTag" title="checkdmarc.mta_sts.InvalidMTASTSTag"><strong>checkdmarc.mta_sts.InvalidMTASTSTag</strong></a> – </p></li>
<li><p><strong>checkdmarc.mta_sts.InvalidMTASTSTagValue</strong> – </p></li>
<li><p><strong>checkdmarc.mta_sts.SPFRecordFoundWhereSTSRecordShouldBe</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.mta_sts.query_mta_sts_record">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.mta_sts.</span></span><span class="sig-name descname"><span class="pre">query_mta_sts_record</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Resolver</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OrderedDict</span></span></span><a class="reference internal" href="_modules/checkdmarc/mta_sts.html#query_mta_sts_record"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.mta_sts.query_mta_sts_record" title="Link to this definition"></a></dt>
<dd><p>Queries DNS for an MTA-STS record</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<em>str</em>) – A domain name</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of nameservers to query</p></li>
<li><p><strong>resolver</strong> (<em>dns.resolver.Resolver</em>) – A resolver object to use for DNS
requests</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – number of seconds to wait for a record from DNS</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>An <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> with the following keys:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">record</span></code> - the unparsed MTA-STS record string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warnings</span></code> - warning conditions found</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>OrderedDict</p>
<dl class="simple">
<dt>Raises:</dt><dd><p><a class="reference internal" href="#checkdmarc.mta_sts.MTASTSRecordNotFound" title="checkdmarc.mta_sts.MTASTSRecordNotFound"><code class="xref py py-exc docutils literal notranslate"><span class="pre">checkdmarc.mta_sts.MTASTSRecordNotFound</span></code></a>
<a class="reference internal" href="#checkdmarc.mta_sts.MTASTSRecordInWrongLocation" title="checkdmarc.mta_sts.MTASTSRecordInWrongLocation"><code class="xref py py-exc docutils literal notranslate"><span class="pre">checkdmarc.mta_sts.MTASTSRecordInWrongLocation</span></code></a>
<a class="reference internal" href="#checkdmarc.mta_sts.MultipleMTASTSRecords" title="checkdmarc.mta_sts.MultipleMTASTSRecords"><code class="xref py py-exc docutils literal notranslate"><span class="pre">checkdmarc.mta_sts.MultipleMTASTSRecords</span></code></a></p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="checkdmarc-smtp-tls-reporting">
<h2>checkdmarc.smtp_tls_reporting<a class="headerlink" href="#checkdmarc-smtp-tls-reporting" title="Link to this heading"></a></h2>
<p>## checkdmarc.smtp</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>{eval-rst}
.. automodule:: checkdmarc.smtp</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">members<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
</section>
<section id="module-checkdmarc.spf">
<span id="checkdmarc-spf"></span><h2>checkdmarc.spf<a class="headerlink" href="#module-checkdmarc.spf" title="Link to this heading"></a></h2>
<p>Sender Policy framework (SPF) record validation</p>
<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.spf.MultipleSPFRTXTRecords">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.spf.</span></span><span class="sig-name descname"><span class="pre">MultipleSPFRTXTRecords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/spf.html#MultipleSPFRTXTRecords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.spf.MultipleSPFRTXTRecords" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the output</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.spf.SPFError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.spf.</span></span><span class="sig-name descname"><span class="pre">SPFError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/spf.html#SPFError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.spf.SPFError" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the output</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.spf.SPFIncludeLoop">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.spf.</span></span><span class="sig-name descname"><span class="pre">SPFIncludeLoop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/spf.html#SPFIncludeLoop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.spf.SPFIncludeLoop" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the output</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.spf.SPFRecordNotFound">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.spf.</span></span><span class="sig-name descname"><span class="pre">SPFRecordNotFound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/spf.html#SPFRecordNotFound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.spf.SPFRecordNotFound" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the output</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.spf.SPFRedirectLoop">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.spf.</span></span><span class="sig-name descname"><span class="pre">SPFRedirectLoop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/spf.html#SPFRedirectLoop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.spf.SPFRedirectLoop" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the output</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.spf.SPFSyntaxError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.spf.</span></span><span class="sig-name descname"><span class="pre">SPFSyntaxError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/spf.html#SPFSyntaxError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.spf.SPFSyntaxError" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the output</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.spf.SPFTooManyDNSLookups">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.spf.</span></span><span class="sig-name descname"><span class="pre">SPFTooManyDNSLookups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/spf.html#SPFTooManyDNSLookups"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.spf.SPFTooManyDNSLookups" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the output</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.spf.SPFTooManyVoidDNSLookups">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.spf.</span></span><span class="sig-name descname"><span class="pre">SPFTooManyVoidDNSLookups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/spf.html#SPFTooManyVoidDNSLookups"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.spf.SPFTooManyVoidDNSLookups" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The error message</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary of data to include in the output</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.spf.check_spf">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.spf.</span></span><span class="sig-name descname"><span class="pre">check_spf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parked</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Resolver</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OrderedDict</span></span></span><a class="reference internal" href="_modules/checkdmarc/spf.html#check_spf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.spf.check_spf" title="Link to this definition"></a></dt>
<dd><p>Returns a dictionary with a parsed SPF record or an error.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<em>str</em>) – A domain name</p></li>
<li><p><strong>parked</strong> (<em>bool</em>) – The domain is parked</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of nameservers to query</p></li>
<li><p><strong>resolver</strong> (<em>dns.resolver.Resolver</em>) – A resolver object to use for DNS
requests</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – number of seconds to wait for an answer from DNS</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>An <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> with the following keys:</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">record</span></code> - The SPF record string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parsed</span></code> - The parsed SPF record</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dns_lookups</span></code> - The number of DNS lookups</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dns_void_lookups</span></code> - The number of void DNS lookups</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">valid</span></code> - True</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warnings</span></code> - A <code class="docutils literal notranslate"><span class="pre">list</span></code> of warnings</p></li>
</ul>
</div></blockquote>
<p>If a DNS error occurs, the dictionary will have the
following keys:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">error</span></code> - Tne error message</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">valid</span></code> - False</p></li>
</ul>
</div></blockquote>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OrderedDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.spf.get_spf_record">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.spf.</span></span><span class="sig-name descname"><span class="pre">get_spf_record</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Resolver</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OrderedDict</span></span></span><a class="reference internal" href="_modules/checkdmarc/spf.html#get_spf_record"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.spf.get_spf_record" title="Link to this definition"></a></dt>
<dd><p>Retrieves and parses an SPF record</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<em>str</em>) – A domain name</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of nameservers to query</p></li>
<li><p><strong>resolver</strong> (<em>dns.resolver.Resolver</em>) – A resolver object to use for DNS
requests</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – Number of seconds to wait for an answer from DNS</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An SPF record parsed by result</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OrderedDict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>checkdmarc.SPFRecordNotFound</strong> – </p></li>
<li><p><strong>checkdmarc.SPFIncludeLoop</strong> – </p></li>
<li><p><strong>checkdmarc.SPFRedirectLoop</strong> – </p></li>
<li><p><strong>checkdmarc.SPFSyntaxError</strong> – </p></li>
<li><p><strong>checkdmarc.SPFTooManyDNSLookups</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.spf.parse_spf_record">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.spf.</span></span><span class="sig-name descname"><span class="pre">parse_spf_record</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parked</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Resolver</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recursion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">OrderedDict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">syntax_error_marker</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'➞'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OrderedDict</span></span></span><a class="reference internal" href="_modules/checkdmarc/spf.html#parse_spf_record"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.spf.parse_spf_record" title="Link to this definition"></a></dt>
<dd><p>Parses an SPF record, including resolving <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">mx</span></code>, and <code class="docutils literal notranslate"><span class="pre">include</span></code>
mechanisms</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>record</strong> (<em>str</em>) – An SPF record</p></li>
<li><p><strong>domain</strong> (<em>str</em>) – The domain that the SPF record came from</p></li>
<li><p><strong>parked</strong> (<em>bool</em>) – indicated if a domain has been parked</p></li>
<li><p><strong>seen</strong> (<em>list</em>) – A list of domains seen in past loops</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of nameservers to query</p></li>
<li><p><strong>resolver</strong> (<em>dns.resolver.Resolver</em>) – A resolver object to use for DNS
requests</p></li>
<li><p><strong>recursion</strong> (<em>OrderedDict</em>) – Results from a previous call</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – number of seconds to wait for an answer from DNS</p></li>
<li><p><strong>syntax_error_marker</strong> (<em>str</em>) – The maker for pointing out syntax errors</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>An <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> with the following keys:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dns_lookups</span></code> - Number of DNS lookups required by the record</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parsed</span></code> - An <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> of a parsed SPF record values</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warnings</span></code> - A <code class="docutils literal notranslate"><span class="pre">list</span></code> of warnings</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OrderedDict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>checkdmarc.SPFIncludeLoop</strong> – </p></li>
<li><p><strong>checkdmarc.SPFRedirectLoop</strong> – </p></li>
<li><p><strong>checkdmarc.SPFSyntaxError</strong> – </p></li>
<li><p><strong>checkdmarc.SPFTooManyDNSLookups</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.spf.query_spf_record">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.spf.</span></span><span class="sig-name descname"><span class="pre">query_spf_record</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Resolver</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OrderedDict</span></span></span><a class="reference internal" href="_modules/checkdmarc/spf.html#query_spf_record"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.spf.query_spf_record" title="Link to this definition"></a></dt>
<dd><p>Queries DNS for an SPF record</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<em>str</em>) – A domain name</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of nameservers to query</p></li>
<li><p><strong>resolver</strong> (<em>dns.resolver.Resolver</em>) – A resolver object to use for DNS
requests</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – number of seconds to wait for an answer from DNS</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>An <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> with the following keys:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">record</span></code> - The SPF record string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warnings</span></code> - A <code class="docutils literal notranslate"><span class="pre">list</span></code> of warnings</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OrderedDict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>checkdmarc.SPFRecordNotFound</strong> – </p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-checkdmarc.utils">
<span id="checkdmarc-utils"></span><h2>checkdmarc.utils<a class="headerlink" href="#module-checkdmarc.utils" title="Link to this heading"></a></h2>
<p>DNS utility functions</p>
<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.utils.DNSException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.utils.</span></span><span class="sig-name descname"><span class="pre">DNSException</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/utils.html#DNSException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.utils.DNSException" title="Link to this definition"></a></dt>
<dd><p>Raised when a general DNS error occurs</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="checkdmarc.utils.DNSExceptionNXDOMAIN">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">checkdmarc.utils.</span></span><span class="sig-name descname"><span class="pre">DNSExceptionNXDOMAIN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/checkdmarc/utils.html#DNSExceptionNXDOMAIN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.utils.DNSExceptionNXDOMAIN" title="Link to this definition"></a></dt>
<dd><p>Raised when a NXDOMAIN DNS error (RCODE:3) occurs</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.utils.get_a_records">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.utils.</span></span><span class="sig-name descname"><span class="pre">get_a_records</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Resolver</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/checkdmarc/utils.html#get_a_records"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.utils.get_a_records" title="Link to this definition"></a></dt>
<dd><p>Queries DNS for A and AAAA records</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<em>str</em>) – A domain name</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of nameservers to query</p></li>
<li><p><strong>resolver</strong> (<em>dns.resolver.Resolver</em>) – A resolver object to use for DNS
requests</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – number of seconds to wait for an answer from DNS</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A sorted list of IPv4 and IPv6 addresses</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>checkdmarc.DNSException</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.utils.get_base_domain">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.utils.</span></span><span class="sig-name descname"><span class="pre">get_base_domain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/checkdmarc/utils.html#get_base_domain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.utils.get_base_domain" title="Link to this definition"></a></dt>
<dd><p>Gets the base domain name for the given domain</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Results are based on a list of public domain suffixes at
<a class="reference external" href="https://publicsuffix.org/list/public_suffix_list.dat">https://publicsuffix.org/list/public_suffix_list.dat</a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>domain</strong> (<em>str</em>) – A domain or subdomain</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The base domain of the given domain</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.utils.get_mx_records">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.utils.</span></span><span class="sig-name descname"><span class="pre">get_mx_records</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Resolver</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">OrderedDict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/checkdmarc/utils.html#get_mx_records"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.utils.get_mx_records" title="Link to this definition"></a></dt>
<dd><p>Queries DNS for a list of Mail Exchange hosts</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<em>str</em>) – A domain name</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of nameservers to query</p></li>
<li><p><strong>resolver</strong> (<em>dns.resolver.Resolver</em>) – A resolver object to use for DNS
requests</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – number of seconds to wait for an answer from DNS</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A list of <code class="docutils literal notranslate"><span class="pre">OrderedDicts</span></code>; each containing a <code class="docutils literal notranslate"><span class="pre">preference</span></code></dt><dd><p>integer and a <code class="docutils literal notranslate"><span class="pre">hostname</span></code></p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>checkdmarc.DNSException</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.utils.get_nameservers">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.utils.</span></span><span class="sig-name descname"><span class="pre">get_nameservers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approved_nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Resolver</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/checkdmarc/utils.html#get_nameservers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.utils.get_nameservers" title="Link to this definition"></a></dt>
<dd><p>Gets a list of nameservers for a given domain</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<em>str</em>) – A domain name</p></li>
<li><p><strong>approved_nameservers</strong> (<em>list</em>) – A list of approved nameserver substrings</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of nameservers to query</p></li>
<li><p><strong>resolver</strong> (<em>dns.resolver.Resolver</em>) – A resolver object to use for DNS
requests</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – number of seconds to wait for a record from DNS</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A dictionary with the following keys:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">hostnames</span></code> - A list of nameserver hostnames</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warnings</span></code>  - A list of warnings</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OrderedDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.utils.get_reverse_dns">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.utils.</span></span><span class="sig-name descname"><span class="pre">get_reverse_dns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ip_address</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Resolver</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/checkdmarc/utils.html#get_reverse_dns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.utils.get_reverse_dns" title="Link to this definition"></a></dt>
<dd><p>Queries for an IP addresses reverse DNS hostname(s)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ip_address</strong> (<em>str</em>) – An IPv4 or IPv6 address</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of nameservers to query</p></li>
<li><p><strong>resolver</strong> (<em>dns.resolver.Resolver</em>) – A resolver object to use for DNS
requests</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – number of seconds to wait for an answer from DNS</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of reverse DNS hostnames</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>checkdmarc.DNSException</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.utils.get_txt_records">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.utils.</span></span><span class="sig-name descname"><span class="pre">get_txt_records</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Resolver</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/checkdmarc/utils.html#get_txt_records"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.utils.get_txt_records" title="Link to this definition"></a></dt>
<dd><p>Queries DNS for TXT records</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<em>str</em>) – A domain name</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of nameservers to query</p></li>
<li><p><strong>resolver</strong> (<em>dns.resolver.Resolver</em>) – A resolver object to use for DNS
requests</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – number of seconds to wait for an answer from DNS</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of TXT records</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>list</p>
<dl class="simple">
<dt>Raises:</dt><dd><p><code class="xref py py-exc docutils literal notranslate"><span class="pre">checkdmarc.DNSException</span></code></p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="checkdmarc.utils.query_dns">
<span class="sig-prename descclassname"><span class="pre">checkdmarc.utils.</span></span><span class="sig-name descname"><span class="pre">query_dns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nameservers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Resolver</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ExpiringDict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/checkdmarc/utils.html#query_dns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#checkdmarc.utils.query_dns" title="Link to this definition"></a></dt>
<dd><p>Queries DNS</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<em>str</em>) – The domain or subdomain to query about</p></li>
<li><p><strong>record_type</strong> (<em>str</em>) – The record type to query for</p></li>
<li><p><strong>nameservers</strong> (<em>list</em>) – A list of one or more nameservers to use</p></li>
<li><p><strong>resolver</strong> (<em>dns.resolver.Resolver</em>) – A resolver object to use for DNS
requests</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – Sets the DNS timeout in seconds</p></li>
<li><p><strong>cache</strong> (<em>ExpiringDict</em>) – Cache storage</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of answers</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cli.html" class="btn btn-neutral float-right" title="CLI" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, Sean Whalen.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>